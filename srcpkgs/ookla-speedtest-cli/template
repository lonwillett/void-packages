# Template file for 'ookla-speedtest-cli'
pkgname=ookla-speedtest-cli
version=1.1.1
revision=1
create_wrksrc=yes
build_style="fetch"

short_desc="Ookla's bandwidth test tool using speedtest.net"
maintainer="Lon Willett <xgit@lonw.net>"
homepage="https://www.speedtest.net/apps/cli"
license="Proprietary"
repository="nonfree"
archs="x86_64 x86_64-musl i686 i686-musl aarch64 aarch64-musl armv7l armv7l-musl armv6l armv6l-musl"
hostmakedepends="tar"
nostrip="yes"

case "${XBPS_TARGET_MACHINE}" in
	x86_64*)
		_arch="x86_64"
		checksum=970477fdfee4d741e75f088faf648f9b51c7be04313fb88ffb5de07eb1a3040c
		;;
	i686*)
		_arch="i386"
		checksum=2854018a9319ff73d19212c497bb3c329dd53aae2fd28a1b5f94ede619c1d976
		;;
	aarch64*)
		_arch="aarch64"
		checksum=276a40873fe1c3ca24a21580c2fc64aa92ed358ffc6db6071a13d03a8d431fd9
		;;
	armv7l*)
		_arch="armhf"
		checksum=78cf629619043535640a0a6de7a1c7b6f8d837768baee13e296655e3d830c3da
		;;
	armv6l*)
		_arch="armel"
		checksum=87cd7e1790576a2cb2b3e5f5412f7dded553996487d49c991435e7544c10055b  -
		;;
esac

_filename="ookla-speedtest-${version}-linux-${_arch}.tgz"
distfiles="https://install.speedtest.net/app/cli/${_filename}"

post_extract() {
	tar xzf "${_filename}"
}

do_install() {
	vbin speedtest ookla-speedtest
	vman speedtest.5 ookla-speedtest.5
	#vinstall speedtest.md
}
