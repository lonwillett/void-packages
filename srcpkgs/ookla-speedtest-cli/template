# Template file for 'ookla-speedtest-cli'
pkgname=ookla-speedtest-cli
version=1.2.0
revision=1
create_wrksrc=yes
build_style="fetch"
short_desc="Ookla's bandwidth test tool using speedtest.net"
maintainer="Lon Willett <xgit@lonw.net>"
homepage="https://www.speedtest.net/apps/cli"
license="Proprietary"
repository="nonfree"
archs="x86_64 x86_64-musl i686 i686-musl aarch64 aarch64-musl armv7l armv7l-musl armv6l armv6l-musl"
hostmakedepends="tar"
nostrip="yes"

case "${XBPS_TARGET_MACHINE}" in
	x86_64*)
		_arch="x86_64"
		checksum=5690596c54ff9bed63fa3732f818a05dbc2db19ad36ed68f21ca5f64d5cfeeb7
		;;
	i686*)
		_arch="i386"
		checksum=9ff7e18dbae7ee0e03c66108445a2fb6ceea6c86f66482e1392f55881b772fe8
		;;
	aarch64*)
		_arch="aarch64"
		checksum=3953d231da3783e2bf8904b6dd72767c5c6e533e163d3742fd0437affa431bd3
		;;
	armv7l*)
		_arch="armhf"
		checksum=e45fcdebbd8a185553535533dd032d6b10bc8c64eee4139b1147b9c09835d08d
		;;
	armv6l*)
		_arch="armel"
		checksum=629a455a2879224bd0dbd4b36d8c721dda540717937e4660b4d2c966029466bf
		;;
esac

_filename="ookla-speedtest-${version}-linux-${_arch}.tgz"
distfiles="https://install.speedtest.net/app/cli/${_filename}"

post_extract() {
	tar xzf "${_filename}"
}

do_install() {
	vbin speedtest ookla-speedtest
	vman speedtest.5 ookla-speedtest.5
	#vinstall speedtest.md
}
