# Template file for 'skypeforlinux'
# This just repackages the debian package.
pkgname=skypeforlinux
version=5.2.0.1
revision=1
only_for_archs="x86_64"
repository="nonfree"
build_style="fetch"
nostrip="yes"
short_desc="Skype for Linux Beta"
maintainer="Lon Willett <xgit@lonw.net>"
license="skype"
homepage="https://www.skype.com"
distfiles="https://repo.skype.com/deb/pool/main/${pkgname:0:1}/${pkgname}/${pkgname}_${version}_amd64.deb"
checksum=06448297eda5f183ed529a5853dfc32b1faa0d9e5af76f97f6b32a5179919eb7

# NB: gnome-keyring doesn't seem to be necessary, but it will probably
# remember your passwords for you (I haven't actually tried it out).
# Other than that, the automatically generated dependencies should work fine.
#depends="gnome-keyring"

do_extract() {
	ar p ${XBPS_SRCDISTDIR}/${pkgname}-${version}/${pkgname}_${version}_amd64.deb data.tar.xz | tar xJpf - ./usr
}

do_install() {

	vbin usr/bin/skypeforlinux

	vmkdir usr/share
	vcopy usr/share/skypeforlinux usr/share

	# These files must go in expected location, but
	# perhaps some symbolic links are called for?
	vmkdir usr/share/doc
	vcopy usr/share/doc/skypeforlinux usr/share/doc
	#vlicense usr/share/doc/skypeforlinux/copyright
	#vlicense usr/share/doc/skypeforlinux/third-party_attributions.html

	vinstall usr/share/applications/skypeforlinux.desktop 644 usr/share/applications
	vinstall usr/share/pixmaps/skypeforlinux.png 644 usr/share/pixmaps
	find usr/share/icons -type f -print | while read _f; do
		vinstall "${_f}" 644 "${_f%/*}"
	done
}
